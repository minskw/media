<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#14b8a6">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/128/7300/7300981.png">
    <title>🌙 Islam itu Indah dan Mudah - Media Pembelajaran Interaktif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .arabic-text {
            font-family: 'Amiri', serif;
            font-size: 1.2em;
            line-height: 1.8;
            direction: rtl;
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .arabic-text {
                font-size: 1.5em;
            }
        }
        
        /* Background Animations */
        .gradient-bg {
            background: linear-gradient(-45deg, #14b8a6, #0d9488, #10b981, #059669);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Card Animations */
        .card-hover {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }
        
        .card-hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        
        .card-hover:hover::before {
            left: 100%;
        }
        
        /* Progress Bar Animations */
        .progress-bar {
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, .2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, .2) 50%,
                rgba(255, 255, 255, .2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 50px 50px;
            animation: move 2s linear infinite;
        }
        
        @keyframes move {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }
        
        /* Navigation */
        .nav-item {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .nav-item:hover {
            transform: translateY(-2px);
        }
        
        .nav-item.active {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        /* Page Transitions */
        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Avatar Selection */
        .avatar-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .avatar-option:hover {
            transform: scale(1.1);
        }
        
        .avatar-option.selected {
            border: 4px solid #3b82f6;
            transform: scale(1.1);
        }
        
        /* Calculator Styles */
        .calculator-input {
            transition: all 0.3s ease;
        }
        
        .calculator-input:focus {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        
        /* Payment Simulation */
        .payment-method {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .payment-method:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .payment-method.selected {
            border: 2px solid #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        
        /* Certificate Styles */
        .certificate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 8px solid #ffd700;
            position: relative;
            width: 1000px !important;
            height: 707px !important;
            aspect-ratio: 1.414/1 !important;
        }
        
        .certificate::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid #ffd700;
            pointer-events: none;
        }
        
        /* Certificate mobile adjustments */
        @media (max-width: 768px) {
            .certificate {
                width: 100% !important;
                height: auto !important;
                min-height: 500px;
                aspect-ratio: 1.414/1 !important;
            }
        }
        
        /* Animation for explanation */
        .animate-fadeIn {
            animation: fadeInUp 0.5s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .card-hover:hover {
                transform: translateY(-3px) scale(1.005);
            }
            
            .nav-item {
                font-size: 0.75rem;
                padding: 0.5rem 0.75rem;
            }
            
            .nav-item i {
                font-size: 0.875rem;
            }
            
            /* Touch-friendly buttons */
            button, .quiz-option {
                min-height: 44px;
                touch-action: manipulation;
            }
            
            /* Prevent zoom on input focus */
            input, select, textarea {
                font-size: 16px;
            }
            
            /* Modal adjustments for mobile */
            .fixed.inset-0 > div {
                margin: 1rem;
                max-height: calc(100vh - 2rem);
            }
            
            /* Certificate mobile adjustments moved to main certificate section */
        }
        
        @media (max-width: 480px) {
            /* Extra small screens */
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .grid {
                gap: 1rem;
            }
            
            .text-3xl {
                font-size: 1.5rem;
            }
            
            .text-2xl {
                font-size: 1.25rem;
            }
            
            .p-8 {
                padding: 1.5rem;
            }
            
            .p-6 {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Welcome Form -->
    <div id="welcomeForm" class="fixed inset-0 bg-gradient-to-br from-blue-600 to-purple-700 flex items-center justify-center z-50 p-2">
        <div class="bg-white rounded-2xl md:rounded-3xl p-4 md:p-6 max-w-md w-full shadow-2xl max-h-screen overflow-y-auto">
            <div class="text-center mb-4 md:mb-6">
                <div class="w-16 h-16 md:w-20 md:h-20 mx-auto mb-2 md:mb-4">
                    <img src="https://cdn-icons-png.flaticon.com/128/7300/7300981.png" alt="Logo ISLAM ITU INDAH DAN MUDAH" class="w-full h-full object-contain">
                </div>
                <h2 class="text-xl md:text-3xl font-bold text-gray-800 mb-1 md:mb-2">Selamat Datang!</h2>
                <p class="text-sm md:text-base text-gray-600">Mari berkenalan sebelum memulai pembelajaran</p>
            </div>
            
            <form id="profileForm" class="space-y-3 md:space-y-4">
                <div>
                    <label class="block text-xs md:text-sm font-bold text-gray-700 mb-1 md:mb-2">
                        <i class="fas fa-user mr-1 md:mr-2"></i>Nama Lengkap
                    </label>
                    <input type="text" id="userName" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-gray-300 rounded-lg md:rounded-xl focus:border-blue-500 focus:outline-none transition-all text-sm md:text-base" placeholder="Masukkan nama lengkap" required>
                </div>
                
                <div>
                    <label class="block text-xs md:text-sm font-bold text-gray-700 mb-1 md:mb-2">
                        <i class="fas fa-graduation-cap mr-1 md:mr-2"></i>Kelas
                    </label>
                    <select id="userClass" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-gray-300 rounded-lg md:rounded-xl focus:border-blue-500 focus:outline-none transition-all text-sm md:text-base" required>
                        <option value="">Pilih Kelas</option>
                        <option value="5A">5A (Lima A)</option>
                        <option value="5B">5B (Lima B)</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-xs md:text-sm font-bold text-gray-700 mb-2 md:mb-3">
                        <i class="fas fa-camera mr-1 md:mr-2"></i>Foto Profil
                    </label>
                    
                    <!-- Photo Upload Area - Compact -->
                    <div class="text-center mb-2 md:mb-3">
                        <div id="photoPreview" class="w-20 h-20 md:w-24 md:h-24 mx-auto bg-gray-100 rounded-full border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden cursor-pointer hover:border-blue-400 transition-all" onclick="document.getElementById('photoInput').click()">
                            <div id="photoPlaceholder" class="text-center">
                                <i class="fas fa-camera text-lg md:text-2xl text-gray-400 mb-1"></i>
                                <p class="text-xs text-gray-500">Upload</p>
                            </div>
                        </div>
                        <input type="file" id="photoInput" accept="image/*" class="hidden">
                        <p class="text-xs text-gray-500 mt-1">JPG/PNG (Max 5MB)</p>
                    </div>
                    
                    <!-- Default Avatar Options - Compact -->
                    <div class="text-center">
                        <p class="text-xs md:text-sm text-gray-600 mb-2">Atau pilih avatar:</p>
                        <div class="flex justify-center gap-2 md:gap-3">
                            <div class="avatar-option w-8 h-8 md:w-10 md:h-10 bg-blue-100 rounded-full border-2 border-gray-300 cursor-pointer hover:border-blue-400 flex items-center justify-center" data-avatar="default1">
                                <i class="fas fa-user text-blue-500 text-xs md:text-sm"></i>
                            </div>
                            <div class="avatar-option w-8 h-8 md:w-10 md:h-10 bg-pink-100 rounded-full border-2 border-gray-300 cursor-pointer hover:border-pink-400 flex items-center justify-center" data-avatar="default2">
                                <i class="fas fa-user-graduate text-pink-500 text-xs md:text-sm"></i>
                            </div>
                            <div class="avatar-option w-8 h-8 md:w-10 md:h-10 bg-green-100 rounded-full border-2 border-gray-300 cursor-pointer hover:border-green-400 flex items-center justify-center" data-avatar="default3">
                                <i class="fas fa-child text-green-500 text-xs md:text-sm"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 md:py-4 rounded-lg md:rounded-xl font-bold text-sm md:text-lg hover:from-blue-600 hover:to-purple-700 transition-all hover:scale-105 mt-4 md:mt-6">
                    <i class="fas fa-rocket mr-1 md:mr-2"></i>Mulai Belajar
                </button>
            </form>
        </div>
    </div>

    <!-- Header -->
    <div class="gradient-bg text-white py-4 md:py-6 relative overflow-hidden">
        <div class="container mx-auto px-2 md:px-4">
            <!-- Logo and Title -->
            <div class="flex justify-between items-center mb-4 md:mb-0">
                <div class="flex items-center">
                    <div class="mr-2 md:mr-4">
                        <div class="w-12 h-12 md:w-16 md:h-16">
                            <img src="https://cdn-icons-png.flaticon.com/128/7300/7300981.png" alt="Logo ISLAM ITU INDAH DAN MUDAH" class="w-full h-full object-contain" onerror="this.src=''; this.alt='Logo failed to load'; this.style.display='none';">
                        </div>
                    </div>
                    <div>
                        <h1 class="text-lg md:text-2xl lg:text-3xl font-bold leading-tight">ISLAM ITU INDAH DAN MUDAH</h1>
                        <p class="text-xs md:text-sm lg:text-base font-semibold opacity-90">Media Pembelajaran Interaktif</p>
                        <p class="text-sm md:text-lg lg:text-xl font-semibold opacity-90">FIKIH KELAS 5 MIN SINGKAWANG</p>
                    </div>
                </div>
                
                <!-- User Profile - Desktop Only -->
                <div id="userProfile" class="hidden md:flex items-center bg-white rounded-2xl px-4 py-3 shadow-lg border-2 border-white/30 min-w-0">
                    <div id="userAvatar" class="w-14 h-14 bg-gray-100 rounded-full overflow-hidden mr-4 shadow-md flex-shrink-0">
                        <svg viewBox="0 0 100 100" class="w-full h-full">
                            <circle cx="50" cy="50" r="50" fill="#e3f2fd"/>
                            <circle cx="50" cy="35" r="15" fill="#ffdbcb"/>
                            <path d="M35 45 Q50 30 65 45 Q65 60 50 65 Q35 60 35 45" fill="#ffdbcb"/>
                            <circle cx="43" cy="38" r="2" fill="#333"/>
                            <circle cx="57" cy="38" r="2" fill="#333"/>
                            <path d="M45 45 Q50 48 55 45" stroke="#333" stroke-width="1" fill="none"/>
                            <path d="M30 25 Q50 15 70 25 Q70 35 50 40 Q30 35 30 25" fill="#8b4513"/>
                        </svg>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div id="userNameDisplay" class="font-bold text-lg text-gray-800 truncate">Siswa</div>
                        <div id="userClassDisplay" class="text-sm text-gray-600 mb-2">Kelas -</div>
                        <!-- Progress Bar -->
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="userProgressBar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-600 mt-1">
                            <span>Progress Belajar</span>
                            <span id="userProgressText">0%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="mt-4 md:mt-6">
                <div class="flex flex-wrap gap-1 md:gap-2 lg:gap-4">
                    <div class="nav-item active px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('dashboard')">
                        <i class="fas fa-home mr-1 md:mr-2"></i><span class="hidden sm:inline">Dashboard</span><span class="sm:hidden">Home</span>
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('zakatFitrah')">
                        <i class="fas fa-coins mr-1 md:mr-2"></i><span class="hidden sm:inline">Zakat Fitrah</span><span class="sm:hidden">Zakat</span>
                    </div>
                    <div id="infakMenu" class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium opacity-50 cursor-not-allowed" onclick="checkMenuAccess('infak')">
                        <i class="fas fa-hand-holding-heart mr-1 md:mr-2"></i><i class="fas fa-lock ml-1 text-xs"></i>Infak
                    </div>
                    <div id="sedekahMenu" class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium opacity-50 cursor-not-allowed" onclick="checkMenuAccess('sedekah')">
                        <i class="fas fa-heart mr-1 md:mr-2"></i><i class="fas fa-lock ml-1 text-xs"></i>Sedekah
                    </div>
                    <div id="qurbanMenu" class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium opacity-50 cursor-not-allowed" onclick="checkMenuAccess('qurban')">
                        <i class="fas fa-cow mr-1 md:mr-2"></i><i class="fas fa-lock ml-1 text-xs"></i>Qurban
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('calculator')">
                        <i class="fas fa-calculator mr-1 md:mr-2"></i><span class="hidden sm:inline">Kalkulator</span><span class="sm:hidden">Calc</span>
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('certificate')">
                        <i class="fas fa-certificate mr-1 md:mr-2"></i><span class="hidden sm:inline">Sertifikat</span><span class="sm:hidden">Cert</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile User Profile Card - Below Header -->
    <div class="md:hidden bg-white shadow-lg mx-2 mt-2 rounded-2xl p-4 border-2 border-gray-100">
        <div class="flex items-center">
            <div id="userAvatarMobile" class="w-16 h-16 bg-gray-100 rounded-full overflow-hidden mr-4 shadow-md flex-shrink-0">
                <svg viewBox="0 0 100 100" class="w-full h-full">
                    <circle cx="50" cy="50" r="50" fill="#e3f2fd"/>
                    <circle cx="50" cy="35" r="15" fill="#ffdbcb"/>
                    <path d="M35 45 Q50 30 65 45 Q65 60 50 65 Q35 60 35 45" fill="#ffdbcb"/>
                    <circle cx="43" cy="38" r="2" fill="#333"/>
                    <circle cx="57" cy="38" r="2" fill="#333"/>
                    <path d="M45 45 Q50 48 55 45" stroke="#333" stroke-width="1" fill="none"/>
                    <path d="M30 25 Q50 15 70 25 Q70 35 50 40 Q30 35 30 25" fill="#8b4513"/>
                </svg>
            </div>
            <div class="flex-1 min-w-0">
                <div id="userNameDisplayMobile" class="font-bold text-lg text-gray-800 truncate mb-1">Siswa</div>
                <div id="userClassDisplayMobile" class="text-sm text-gray-600 mb-3">Kelas -</div>
                <!-- Progress Bar -->
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="userProgressBarMobile" class="bg-gradient-to-r from-blue-500 to-purple-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-600 mt-2">
                    <span>Progress Belajar</span>
                    <span id="userProgressTextMobile">0%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-2 md:px-4 py-4 md:py-8 max-w-7xl">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <!-- Progress Overview -->
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8 mb-4 md:mb-8 card-hover">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-chart-line text-2xl md:text-3xl text-blue-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Ringkasan Pembelajaran</h2>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6">
                    <div class="text-center p-3 md:p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl card-hover">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4">
                            <i class="fas fa-coins text-blue-500"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Zakat Fitrah</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold" id="zakatProgress">0%</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-2 md:h-3 rounded-full progress-bar" id="zakatProgressBar" style="width: 0%"></div>
                        </div>
                        <button class="mt-2 md:mt-4 px-3 md:px-4 py-2 bg-blue-500 text-white rounded-lg text-xs md:text-sm hover:bg-blue-600 transition-all" onclick="showPage('zakatFitrah')">
                            <i class="fas fa-play mr-1"></i>Mulai
                        </button>
                    </div>
                    
                    <div id="infakDashboard" class="text-center p-3 md:p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-2xl opacity-50">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4 relative">
                            <i class="fas fa-hand-holding-heart text-green-500"></i>
                            <i class="fas fa-lock absolute -top-1 -right-1 text-gray-400 text-sm"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Infak</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold">🔒</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 md:h-3 rounded-full" style="width: 0%"></div>
                        </div>
                        <div class="mt-2 md:mt-4 text-xs text-gray-500">Selesaikan Zakat Fitrah (70%)</div>
                    </div>
                    
                    <div id="sedekahDashboard" class="text-center p-3 md:p-6 bg-gradient-to-br from-pink-50 to-pink-100 rounded-2xl opacity-50">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4 relative">
                            <i class="fas fa-heart text-pink-500"></i>
                            <i class="fas fa-lock absolute -top-1 -right-1 text-gray-400 text-sm"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Sedekah</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold">🔒</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-pink-400 to-pink-600 h-2 md:h-3 rounded-full" style="width: 0%"></div>
                        </div>
                        <div class="mt-2 md:mt-4 text-xs text-gray-500">Selesaikan Infak (80%)</div>
                    </div>
                    
                    <div id="qurbanDashboard" class="text-center p-3 md:p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl opacity-50">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4 relative">
                            <i class="fas fa-cow text-purple-500"></i>
                            <i class="fas fa-lock absolute -top-1 -right-1 text-gray-400 text-sm"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Qurban</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold">🔒</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-purple-400 to-purple-600 h-2 md:h-3 rounded-full" style="width: 0%"></div>
                        </div>
                        <div class="mt-2 md:mt-4 text-xs text-gray-500">Selesaikan Sedekah (90%)</div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-6">
                <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover">
                    <div class="flex items-center">
                        <div class="bg-blue-100 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="fas fa-trophy text-blue-600 text-lg md:text-xl"></i>
                        </div>
                        <div>
                            <div class="text-xl md:text-2xl font-bold text-gray-800" id="totalBadges">0</div>
                            <div class="text-xs md:text-sm text-gray-600">Badge Diraih</div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover">
                    <div class="flex items-center">
                        <div class="bg-green-100 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="fas fa-check-circle text-green-600 text-lg md:text-xl"></i>
                        </div>
                        <div>
                            <div class="text-xl md:text-2xl font-bold text-gray-800" id="completedModules">0/4</div>
                            <div class="text-xs md:text-sm text-gray-600">Modul Selesai</div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover">
                    <div class="flex items-center">
                        <div class="bg-purple-100 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="fas fa-clock text-purple-600 text-lg md:text-xl"></i>
                        </div>
                        <div>
                            <div class="text-xl md:text-2xl font-bold text-gray-800" id="studyTime">0 menit</div>
                            <div class="text-xs md:text-sm text-gray-600">Waktu Belajar</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Zakat Fitrah Page -->
        <div id="zakatFitrah" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8 mb-4 md:mb-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-coins text-2xl md:text-3xl text-blue-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Pembelajaran Zakat Fitrah</h2>
                </div>
                
                <!-- Learning Progress Overview -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 md:p-6 rounded-2xl mb-6 md:mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg md:text-xl font-bold text-blue-800">
                            <i class="fas fa-chart-line mr-2"></i>Progress Pembelajaran
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl md:text-3xl font-bold text-blue-600" id="zakatOverallScore">0%</div>
                            <div class="text-xs md:text-sm text-blue-700">Nilai Akhir</div>
                        </div>
                    </div>
                    <div class="w-full bg-white rounded-full h-3 md:h-4">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 md:h-4 rounded-full transition-all duration-500" id="zakatOverallProgress" style="width: 0%"></div>
                    </div>
                    <p class="text-xs md:text-sm text-blue-600 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Selesaikan semua modul untuk membuka materi selanjutnya
                    </p>
                </div>
                
                <!-- Learning Modules -->
                <div class="mb-6 md:mb-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">
                        <i class="fas fa-book-open mr-2"></i>Modul Pembelajaran
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6" id="learningModules">
                        <!-- Modules will be dynamically generated -->
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="border-t pt-6 md:pt-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">
                        <i class="fas fa-tools mr-2"></i>Alat Bantu Pembelajaran
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                        <button class="flex items-center justify-center px-4 md:px-6 py-3 md:py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all hover:scale-105" onclick="showPage('calculator')">
                            <i class="fas fa-calculator mr-2 md:mr-3 text-lg md:text-xl"></i>
                            <div class="text-left">
                                <div class="font-bold text-sm md:text-base">Kalkulator Zakat</div>
                                <div class="text-xs md:text-sm opacity-90">Hitung zakat dengan mudah</div>
                            </div>
                        </button>
                        
                        <button class="flex items-center justify-center px-4 md:px-6 py-3 md:py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all hover:scale-105" onclick="showQuiz('zakat')">
                            <i class="fas fa-question-circle mr-2 md:mr-3 text-lg md:text-xl"></i>
                            <div class="text-left">
                                <div class="font-bold text-sm md:text-base">Kuis Zakat</div>
                                <div class="text-xs md:text-sm opacity-90">Uji pengetahuan Anda</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculator Page -->
        <div id="calculator" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-calculator text-2xl md:text-3xl text-blue-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Kalkulator Zakat</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                    <!-- Zakat Fitrah Calculator -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 md:p-6 rounded-2xl card-hover">
                        <div class="flex items-center mb-4 md:mb-6">
                            <div class="bg-blue-500 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                                <i class="fas fa-coins text-white text-lg md:text-xl"></i>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold text-blue-800">Zakat Fitrah</h3>
                        </div>
                        
                        <div class="mb-4 md:mb-6">
                            <label class="block text-sm md:text-base font-medium text-gray-700 mb-2">Jumlah Anggota Keluarga</label>
                            <input type="number" id="familyMembers" min="1" value="1" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 calculator-input">
                        </div>
                        
                        <div class="mb-4 md:mb-6">
                            <label class="block text-sm md:text-base font-medium text-gray-700 mb-2">Satuan Zakat</label>
                            <select id="zakatUnit" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 calculator-input">
                                <option value="beras">Beras (2.5 kg)</option>
                                <option value="uang">Uang (Setara harga beras)</option>
                            </select>
                        </div>
                        
                        <div id="ricePriceContainer" class="mb-4 md:mb-6 hidden">
                            <label class="block text-sm md:text-base font-medium text-gray-700 mb-2">Harga Beras per Kg (Rp)</label>
                            <input type="number" id="ricePrice" min="10000" value="15000" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 calculator-input">
                        </div>
                        
                        <button id="calculateZakat" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 md:py-4 rounded-lg font-bold text-sm md:text-base hover:from-blue-600 hover:to-blue-700 transition-all hover:scale-105">
                            <i class="fas fa-calculator mr-2"></i>Hitung Zakat
                        </button>
                        
                        <div id="zakatResult" class="mt-4 md:mt-6 p-4 md:p-6 bg-white rounded-lg shadow-md hidden">
                            <h4 class="text-lg md:text-xl font-bold text-blue-800 mb-2">Hasil Perhitungan</h4>
                            <div class="text-sm md:text-base text-gray-700" id="zakatResultText"></div>
                        </div>
                    </div>
                    
                    <!-- Zakat Maal Calculator -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 md:p-6 rounded-2xl card-hover">
                        <div class="flex items-center mb-4 md:mb-6">
                            <div class="bg-green-500 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                                <i class="fas fa-piggy-bank text-white text-lg md:text-xl"></i>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold text-green-800">Zakat Maal</h3>
                        </div>
                        
                        <div class="mb-4 md:mb-6">
                            <label class="block text-sm md:text-base font-medium text-gray-700 mb-2">Total Harta (Rp)</label>
                            <input type="number" id="totalWealth" min="0" value="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 calculator-input">
                        </div>
                        
                        <div class="mb-4 md:mb-6">
                            <label class="block text-sm md:text-base font-medium text-gray-700 mb-2">Hutang (Rp)</label>
                            <input type="number" id="debt" min="0" value="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 calculator-input">
                        </div>
                        
                        <div class="mb-4 md:mb-6">
                            <label class="block text-sm md:text-base font-medium text-gray-700 mb-2">Nisab (Rp)</label>
                            <input type="number" id="nisab" min="0" value="85000000" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 calculator-input">
                        </div>
                        
                        <button id="calculateZakatMaal" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 md:py-4 rounded-lg font-bold text-sm md:text-base hover:from-green-600 hover:to-green-700 transition-all hover:scale-105">
                            <i class="fas fa-calculator mr-2"></i>Hitung Zakat Maal
                        </button>
                        
                        <div id="zakatMaalResult" class="mt-4 md:mt-6 p-4 md:p-6 bg-white rounded-lg shadow-md hidden">
                            <h4 class="text-lg md:text-xl font-bold text-green-800 mb-2">Hasil Perhitungan</h4>
                            <div class="text-sm md:text-base text-gray-700" id="zakatMaalResultText"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Certificate Page -->
        <div id="certificate" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-certificate text-2xl md:text-3xl text-blue-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Sertifikat Pembelajaran</h2>
                </div>
                
                <div class="text-center mb-6 md:mb-8">
                    <p class="text-gray-600 mb-4 md:mb-6">Setelah menyelesaikan pembelajaran, Anda akan mendapatkan sertifikat yang dapat diunduh.</p>
                    <button id="generateCertificate" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 md:px-8 py-3 md:py-4 rounded-lg font-bold text-sm md:text-base hover:from-blue-600 hover:to-purple-700 transition-all hover:scale-105">
                        <i class="fas fa-download mr-2"></i>Buat Sertifikat
                    </button>
                </div>
                
                <div class="flex justify-center">
                    <div id="certificateContainer" class="certificate p-8 md:p-16 text-center text-gray-800 shadow-2xl hidden">
                        <div class="absolute top-0 left-0 w-full h-full opacity-10">
                            <svg viewBox="0 0 100 100" class="w-full h-full">
                                <path d="M20,20 L80,20 L80,80 L20,80 Z" fill="none" stroke="currentColor" stroke-width="2" />
                                <path d="M30,30 L70,30 L70,70 L30,70 Z" fill="none" stroke="currentColor" stroke-width="1" />
                                <circle cx="50" cy="50" r="10" fill="none" stroke="currentColor" stroke-width="1" />
                            </svg>
                        </div>
                        
                        <div class="mb-2 md:mb-4">
                            <img src="https://cdn-icons-png.flaticon.com/128/7300/7300981.png" alt="Logo" class="w-16 h-16 md:w-20 md:h-20 mx-auto">
                        </div>
                        
                        <h3 class="text-lg md:text-xl font-bold text-blue-800 mb-1 md:mb-2">SERTIFIKAT PENGHARGAAN</h3>
                        <p class="text-xs md:text-sm mb-4 md:mb-6">Diberikan kepada:</p>
                        
                        <h2 id="certificateName" class="text-2xl md:text-4xl font-bold mb-4 md:mb-6 border-b-2 border-blue-300 pb-2 md:pb-4 inline-block">Nama Siswa</h2>
                        
                        <p class="text-sm md:text-base mb-2 md:mb-4">Telah menyelesaikan pembelajaran</p>
                        <h3 class="text-xl md:text-2xl font-bold text-blue-800 mb-2 md:mb-4">FIKIH KELAS 5 MIN SINGKAWANG</h3>
                        
                        <div class="grid grid-cols-2 gap-4 md:gap-8 mt-6 md:mt-8 text-xs md:text-sm">
                            <div>
                                <div class="border-t-2 border-gray-300 pt-2 md:pt-4">
                                    <div id="certificateDate">Tanggal: 01 Januari 2024</div>
                                </div>
                            </div>
                            <div>
                                <div class="border-t-2 border-gray-300 pt-2 md:pt-4">
                                    <div>Nilai: <span id="certificateScore">A</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 md:mt-12">
                            <div class="flex justify-center space-x-8 md:space-x-16">
                                <div>
                                    <div class="border-t-2 border-gray-400 pt-2 md:pt-4 w-32 md:w-40"></div>
                                    <p class="text-xs md:text-sm">Guru Pembimbing</p>
                                </div>
                                <div>
                                    <div class="border-t-2 border-gray-400 pt-2 md:pt-4 w-32 md:w-40"></div>
                                    <p class="text-xs md:text-sm">Kepala Madrasah</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div id="quizModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-2 md:p-4">
        <div class="bg-white rounded-2xl md:rounded-3xl p-4 md:p-6 max-w-md w-full max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4 md:mb-6">
                <h3 class="text-lg md:text-xl font-bold text-gray-800">Kuis Pembelajaran</h3>
                <button onclick="closeQuiz()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="quizContent">
                <!-- Quiz content will be dynamically generated -->
            </div>
        </div>
    </div>

    <!-- Explanation Modal -->
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-2 md:p-4">
        <div class="bg-white rounded-2xl md:rounded-3xl p-4 md:p-6 max-w-md w-full max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4 md:mb-6">
                <h3 class="text-lg md:text-xl font-bold text-gray-800">Penjelasan Materi</h3>
                <button onclick="closeExplanation()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="explanationContent">
                <!-- Explanation content will be dynamically generated -->
            </div>
            
            <div class="mt-6 md:mt-8 text-center">
                <button onclick="closeExplanation()" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 md:px-8 py-2 md:py-3 rounded-lg font-bold text-sm md:text-base hover:from-blue-600 hover:to-blue-700 transition-all">
                    <i class="fas fa-check mr-2"></i>Mengerti
                </button>
            </div>
        </div>
    </div>

    <!-- Payment Simulation Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-2 md:p-4">
        <div class="bg-white rounded-2xl md:rounded-3xl p-4 md:p-6 max-w-md w-full max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4 md:mb-6">
                <h3 class="text-lg md:text-xl font-bold text-gray-800">Simulasi Pembayaran Zakat</h3>
                <button onclick="closePayment()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="paymentContent">
                <!-- Payment content will be dynamically generated -->
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    <audio id="completeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

    <script>
        // Global variables
        let userData = {
            name: "",
            class: "",
            avatar: "default1",
            progress: {
                zakat: 0,
                infak: 0,
                sedekah: 0,
                qurban: 0
            },
            quizScores: {
                zakat: 0
            },
            studyTime: 0,
            badges: 0,
            completedModules: 0
        };

        let currentQuiz = null;
        let currentQuestion = 0;
        let quizScore = 0;
        let startTime = null;
        
        // Learning modules data
        const learningModules = {
            zakat: [
                {
                    title: "Pengertian Zakat Fitrah",
                    icon: "fas fa-book",
                    color: "blue",
                    completed: false,
                    content: `
                        <h3 class="text-xl font-bold text-blue-800 mb-4">Pengertian Zakat Fitrah</h3>
                        <p class="text-gray-700 mb-4">Zakat Fitrah adalah zakat yang wajib dikeluarkan oleh setiap muslim pada bulan Ramadan, paling lambat sebelum salat Idul Fitri.</p>
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <p class="arabic-text text-2xl mb-2">فَرَضَ رَسُولُ اللَّهِ صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ زَكَاةَ الْفِطْرِ</p>
                            <p class="text-gray-700">"Rasulullah SAW mewajibkan zakat fitrah." (HR. Bukhari dan Muslim)</p>
                        </div>
                        <p class="text-gray-700">Zakat fitrah bertujuan untuk mensucikan orang yang berpuasa dari perbuatan sia-sia dan kata-kata kotor, serta untuk memberikan makanan kepada orang miskin.</p>
                    `
                },
                {
                    title: "Syarat Wajib Zakat Fitrah",
                    icon: "fas fa-check-circle",
                    color: "green",
                    completed: false,
                    content: `
                        <h3 class="text-xl font-bold text-green-800 mb-4">Syarat Wajib Zakat Fitrah</h3>
                        <p class="text-gray-700 mb-4">Berikut adalah syarat-syarat seseorang wajib membayar zakat fitrah:</p>
                        <ul class="list-disc list-inside text-gray-700 space-y-2 mb-4">
                            <li>Beragama Islam</li>
                            <li>Hidup pada bulan Ramadan sampai menjelang Idul Fitri</li>
                            <li>Mempunyai kelebihan makanan untuk diri sendiri dan keluarganya pada malam dan hari raya Idul Fitri</li>
                            <li>Anak yang lahir sebelum matahari terbenam pada akhir Ramadan</li>
                            <li>Orang yang meninggal setelah terbenam matahari pada akhir Ramadan</li>
                        </ul>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <p class="text-gray-700">Bayi yang lahir setelah maghrib pada akhir Ramadan tidak wajib zakat fitrah. Demikian juga orang yang meninggal sebelum maghrib pada akhir Ramadan.</p>
                        </div>
                    `
                },
                {
                    title: "Waktu Pembayaran Zakat",
                    icon: "fas fa-clock",
                    color: "yellow",
                    completed: false,
                    content: `
                        <h3 class="text-xl font-bold text-yellow-800 mb-4">Waktu Pembayaran Zakat Fitrah</h3>
                        <p class="text-gray-700 mb-4">Zakat fitrah memiliki waktu-waktu tertentu dalam pembayarannya:</p>
                        <ol class="list-decimal list-inside text-gray-700 space-y-2 mb-4">
                            <li><strong>Waktu Jawaz (boleh)</strong>: Awal Ramadan sampai akhir Ramadan</li>
                            <li><strong>Waktu Wajib</strong>: Setelah terbenam matahari pada akhir Ramadan</li>
                            <li><strong>Waktu Afdhal (paling utama)</strong>: Sebelum salat Idul Fitri</li>
                            <li><strong>Waktu Makruh</strong>: Setelah salat Idul Fitri sampai terbenam matahari pada hari raya</li>
                            <li><strong>Waktu Haram</strong>: Setelah terbenam matahari pada hari raya Idul Fitri (dikenakan denda)</li>
                        </ol>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <p class="text-gray-700">Rasulullah SAW memerintahkan agar zakat fitrah dibagikan sebelum orang-orang pergi untuk salat Id. Jika dibayarkan setelah salat Id, maka dianggap sebagai sedekah biasa.</p>
                        </div>
                    `
                },
                {
                    title: "Kadar Zakat Fitrah",
                    icon: "fas fa-balance-scale",
                    color: "purple",
                    completed: false,
                    content: `
                        <h3 class="text-xl font-bold text-purple-800 mb-4">Kadar Zakat Fitrah</h3>
                        <p class="text-gray-700 mb-4">Besarnya zakat fitrah yang harus dikeluarkan untuk setiap orang adalah:</p>
                        <div class="bg-purple-50 p-4 rounded-lg mb-4">
                            <p class="text-center text-2xl font-bold text-purple-700">2.5 kg</p>
                            <p class="text-center text-gray-700">atau</p>
                            <p class="text-center text-2xl font-bold text-purple-700">3.5 liter</p>
                            <p class="text-center text-gray-700">makanan pokok (beras, gandum, jagung, dll)</p>
                        </div>
                        <p class="text-gray-700 mb-4">Jika dibayarkan dalam bentuk uang, maka nilainya harus setara dengan harga 2.5 kg makanan pokok yang biasa dikonsumsi.</p>
                        <div class="bg-purple-100 p-4 rounded-lg">
                            <p class="text-gray-700">Para ulama sepakat bahwa kadar zakat fitrah adalah 1 sha' dari makanan pokok. 1 sha' setara dengan 4 mud, dan 1 mud setara dengan jumlah yang dapat memenuhi dua telapak tangan yang sedang digabungkan.</p>
                        </div>
                    `
                },
                {
                    title: "Penerima Zakat Fitrah",
                    icon: "fas fa-hands-helping",
                    color: "pink",
                    completed: false,
                    content: `
                        <h3 class="text-xl font-bold text-pink-800 mb-4">Penerima Zakat Fitrah</h3>
                        <p class="text-gray-700 mb-4">Zakat fitrah hanya diberikan kepada 8 golongan (ashnaf) yang berhak menerima zakat, yaitu:</p>
                        <ol class="list-decimal list-inside text-gray-700 space-y-2 mb-4">
                            <li><strong>Fakir</strong>: Orang yang tidak memiliki harta dan tenaga untuk memenuhi kebutuhan hidupnya</li>
                            <li><strong>Miskin</strong>: Orang yang memiliki harta dan tenaga tetapi tidak cukup untuk memenuhi kebutuhan hidupnya</li>
                            <li><strong>Amil</strong>: Orang yang mengumpulkan dan membagikan zakat</li>
                            <li><strong>Mualaf</strong>: Orang yang baru masuk Islam dan perlu dibina</li>
                            <li><strong>Riqab</strong>: Budak yang ingin memerdekakan dirinya</li>
                            <li><strong>Gharimin</strong>: Orang yang berhutang untuk memenuhi kebutuhan hidupnya</li>
                            <li><strong>Fisabilillah</strong>: Orang yang berjuang di jalan Allah</li>
                            <li><strong>Ibnu Sabil</strong>: Musafir yang kehabisan bekal dalam perjalanan</li>
                        </ol>
                        <div class="bg-pink-50 p-4 rounded-lg">
                            <p class="text-gray-700">Dalam praktiknya, zakat fitrah biasanya lebih diutamakan untuk fakir dan miskin agar mereka dapat merayakan Idul Fitri dengan layak.</p>
                        </div>
                    `
                },
                {
                    title: "Tata Cara Pembayaran",
                    icon: "fas fa-hand-holding-usd",
                    color: "teal",
                    completed: false,
                    content: `
                        <h3 class="text-xl font-bold text-teal-800 mb-4">Tata Cara Pembayaran Zakat Fitrah</h3>
                        <p class="text-gray-700 mb-4">Berikut adalah tata cara pembayaran zakat fitrah yang benar:</p>
                        <ol class="list-decimal list-inside text-gray-700 space-y-2 mb-4">
                            <li>Menentukan jumlah anggota keluarga yang wajib dizakati</li>
                            <li>Menghitung total zakat yang harus dikeluarkan (2.5 kg per orang)</li>
                            <li>Menyiapkan beras atau uang yang akan dizakatkan</li>
                            <li>Membayarkan zakat kepada amil zakat atau langsung kepada mustahik</li>
                            <li>Disunnahkan untuk membaca niat zakat fitrah</li>
                        </ol>
                        <div class="bg-teal-50 p-4 rounded-lg mb-4">
                            <p class="arabic-text text-2xl mb-2">نَوَيْتُ أَنْ أُخْرِجَ زَكَاةَ الْفِطْرِ عَنْ نَفْسِيْ فَرْضًا لِلَّهِ تَعَالَى</p>
                            <p class="text-gray-700">"Aku niat mengeluarkan zakat fitrah untuk diriku sendiri, fardhu karena Allah Ta'ala."</p>
                        </div>
                        <p class="text-gray-700">Zakat fitrah dapat dibayarkan langsung kepada mustahik (penerima zakat) atau melalui lembaga amil zakat yang terpercaya.</p>
                    `
                }
            ]
        };

        // Quiz questions data
        const quizQuestions = {
            zakat: [
                {
                    question: "Apa yang dimaksud dengan zakat fitrah?",
                    options: [
                        "Zakat yang dikeluarkan pada bulan Ramadan",
                        "Zakat harta benda yang dimiliki",
                        "Zakat pertanian dan perkebunan",
                        "Zakat profesi dan penghasilan"
                    ],
                    correct: 0,
                    explanation: "Zakat fitrah adalah zakat yang wajib dikeluarkan oleh setiap muslim pada bulan Ramadan, paling lambat sebelum salat Idul Fitri."
                },
                {
                    question: "Berapa besaran zakat fitrah yang harus dikeluarkan per orang?",
                    options: [
                        "2.5 kg makanan pokok",
                        "3.5 kg makanan pokok",
                        "2.5% dari total harta",
                        "5% dari penghasilan"
                    ],
                    correct: 0,
                    explanation: "Besarnya zakat fitrah untuk setiap orang adalah 2.5 kg makanan pokok atau setara dengan nilai tersebut."
                },
                {
                    question: "Kapan waktu paling utama untuk membayar zakat fitrah?",
                    options: [
                        "Awal Ramadan",
                        "Setelah salat Idul Fitri",
                        "Sebelum salat Idul Fitri",
                        "Akhir Syawal"
                    ],
                    correct: 2,
                    explanation: "Waktu paling utama (afdhal) untuk membayar zakat fitrah adalah sebelum salat Idul Fitri dilaksanakan."
                },
                {
                    question: "Siapa saja yang wajib mengeluarkan zakat fitrah?",
                    options: [
                        "Hanya orang tua",
                        "Hanya kepala keluarga",
                        "Setiap muslim yang mampu",
                        "Hanya yang berpenghasilan tinggi"
                    ],
                    correct: 2,
                    explanation: "Setiap muslim yang mampu dan memenuhi syarat wajib zakat fitrah harus mengeluarkan zakat fitrah untuk dirinya dan orang yang menjadi tanggungannya."
                },
                {
                    question: "Apa tujuan utama zakat fitrah?",
                    options: [
                        "Membersihkan harta",
                        "Mensucikan jiwa orang yang berpuasa",
                        "Membangun masjid",
                        "Membiayai pendidikan"
                    ],
                    correct: 1,
                    explanation: "Zakat fitrah bertujuan untuk mensucikan orang yang berpuasa dari perbuatan sia-sia dan kata-kata kotor, serta untuk memberikan makanan kepada orang miskin."
                }
            ]
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize welcome form
            document.getElementById('profileForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveUserProfile();
            });
            
            // Initialize avatar selection
            document.querySelectorAll('.avatar-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    userData.avatar = this.getAttribute('data-avatar');
                });
            });
            
            // Initialize photo upload
            document.getElementById('photoInput').addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const preview = document.getElementById('photoPreview');
                        preview.innerHTML = `<img src="${event.target.result}" class="w-full h-full object-cover rounded-full">`;
                    }
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
            
            // Initialize zakat calculator
            document.getElementById('zakatUnit').addEventListener('change', function() {
                if (this.value === 'uang') {
                    document.getElementById('ricePriceContainer').classList.remove('hidden');
                } else {
                    document.getElementById('ricePriceContainer').classList.add('hidden');
                }
            });
            
            document.getElementById('calculateZakat').addEventListener('click', calculateZakatFitrah);
            document.getElementById('calculateZakatMaal').addEventListener('click', calculateZakatMaal);
            
            // Initialize certificate generation
            document.getElementById('generateCertificate').addEventListener('click', generateCertificate);
            
            // Load learning modules
            loadLearningModules();
            
            // Start study timer
            startTime = new Date();
            setInterval(updateStudyTime, 1000);
        });

        // Save user profile
        function saveUserProfile() {
            const userName = document.getElementById('userName').value;
            const userClass = document.getElementById('userClass').value;
            
            if (!userName || !userClass) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Silakan isi nama lengkap dan kelas terlebih dahulu!',
                });
                return;
            }
            
            userData.name = userName;
            userData.class = userClass;
            
            // Update user profile display
            document.getElementById('userNameDisplay').textContent = userName;
            document.getElementById('userNameDisplayMobile').textContent = userName;
            document.getElementById('userClassDisplay').textContent = `Kelas ${userClass}`;
            document.getElementById('userClassDisplayMobile').textContent = `Kelas ${userClass}`;
            
            // Hide welcome form
            document.getElementById('welcomeForm').classList.add('hidden');
            
            // Show success message
            Swal.fire({
                icon: 'success',
                title: 'Selamat Datang!',
                text: `Hai ${userName}, selamat belajar Fikih Kelas 5`,
                timer: 2000,
                showConfirmButton: false
            });
        }

        // Show page function
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate the corresponding nav item
            const navItems = document.querySelectorAll('.nav-item');
            for (let i = 0; i < navItems.length; i++) {
                if (navItems[i].onclick.toString().includes(pageId)) {
                    navItems[i].classList.add('active');
                    break;
                }
            }
        }

        // Check menu access
        function checkMenuAccess(menu) {
            const progress = userData.progress;
            
            if (menu === 'infak' && progress.zakat >= 70) {
                document.getElementById('infakMenu').classList.remove('opacity-50', 'cursor-not-allowed');
                showPage('infak');
            } else if (menu === 'sedekah' && progress.infak >= 80) {
                document.getElementById('sedekahMenu').classList.remove('opacity-50', 'cursor-not-allowed');
                showPage('sedekah');
            } else if (menu === 'qurban' && progress.sedekah >= 90) {
                document.getElementById('qurbanMenu').classList.remove('opacity-50', 'cursor-not-allowed');
                showPage('qurban');
            } else {
                let message = '';
                if (menu === 'infak') {
                    message = 'Selesaikan pembelajaran Zakat Fitrah minimal 70% untuk membuka materi Infak';
                } else if (menu === 'sedekah') {
                    message = 'Selesaikan pembelajaran Infak minimal 80% untuk membuka materi Sedekah';
                } else if (menu === 'qurban') {
                    message = 'Selesaikan pembelajaran Sedekah minimal 90% untuk membuka materi Qurban';
                }
                
                Swal.fire({
                    icon: 'info',
                    title: 'Materi Terkunci',
                    text: message,
                });
            }
        }

        // Load learning modules
        function loadLearningModules() {
            const modulesContainer = document.getElementById('learningModules');
            modulesContainer.innerHTML = '';
            
            learningModules.zakat.forEach((module, index) => {
                const moduleElement = document.createElement('div');
                moduleElement.className = `bg-gradient-to-br from-${module.color}-50 to-${module.color}-100 p-4 md:p-6 rounded-2xl card-hover`;
                moduleElement.innerHTML = `
                    <div class="flex items-center mb-4">
                        <div class="bg-${module.color}-500 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="${module.icon} text-white text-lg md:text-xl"></i>
                        </div>
                        <h3 class="text-lg md:text-xl font-bold text-${module.color}-800">${module.title}</h3>
                    </div>
                    <div class="mb-4 md:mb-6">
                        <div class="w-full bg-white rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-${module.color}-400 to-${module.color}-600 h-2 md:h-3 rounded-full progress-bar" style="width: ${module.completed ? '100%' : '0%'}"></div>
                        </div>
                    </div>
                    <button onclick="startLearning(${index})" class="w-full bg-gradient-to-r from-${module.color}-500 to-${module.color}-600 text-white py-2 md:py-3 rounded-lg font-bold text-sm md:text-base hover:from-${module.color}-600 hover:to-${module.color}-700 transition-all hover:scale-105">
                        <i class="fas fa-play mr-2"></i>${module.completed ? 'Ulangi' : 'Mulai'}
                    </button>
                `;
                modulesContainer.appendChild(moduleElement);
            });
        }

        // Start learning a module
        function startLearning(moduleIndex) {
            const module = learningModules.zakat[moduleIndex];
            
            // Show explanation modal with module content
            document.getElementById('explanationContent').innerHTML = module.content;
            document.getElementById('explanationModal').classList.remove('hidden');
            
            // Mark as completed when user closes the explanation
            const originalCloseExplanation = window.closeExplanation;
            window.closeExplanation = function() {
                if (!module.completed) {
                    module.completed = true;
                    userData.progress.zakat += 100 / learningModules.zakat.length;
                    userData.completedModules++;
                    updateProgress();
                    loadLearningModules();
                    
                    // Play completion sound
                    document.getElementById('completeSound').play();
                    
                    // Show congratulation message for first completion
                    Swal.fire({
                        icon: 'success',
                        title: 'Selamat!',
                        text: `Anda telah menyelesaikan modul "${module.title}"`,
                        timer: 2000,
                        showConfirmButton: false
                    });
                }
                
                // Call original function
                originalCloseExplanation();
            };
        }

        // Show quiz
        function showQuiz(topic) {
            if (topic === 'zakat') {
                currentQuiz = 'zakat';
                currentQuestion = 0;
                quizScore = 0;
                displayQuizQuestion();
                document.getElementById('quizModal').classList.remove('hidden');
            }
        }

        // Display quiz question
        function displayQuizQuestion() {
            const quizData = quizQuestions[currentQuiz];
            const question = quizData[currentQuestion];
            
            const quizContent = document.getElementById('quizContent');
            quizContent.innerHTML = `
                <div class="mb-4 md:mb-6">
                    <div class="flex justify-between items-center mb-2 md:mb-4">
                        <span class="text-sm md:text-base text-gray-600">Pertanyaan ${currentQuestion + 1} dari ${quizData.length}</span>
                        <span class="text-sm md:text-base font-bold text-blue-600">Skor: ${quizScore}</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-2 md:h-3 rounded-full" style="width: ${(currentQuestion / quizData.length) * 100}%"></div>
                    </div>
                </div>
                
                <h4 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">${question.question}</h4>
                
                <div class="space-y-3 md:space-y-4 mb-6 md:mb-8">
                    ${question.options.map((option, index) => `
                        <div class="quiz-option p-3 md:p-4 border-2 border-gray-300 rounded-xl cursor-pointer hover:border-blue-400 transition-all" onclick="selectAnswer(${index})">
                            <div class="flex items-center">
                                <div class="w-6 h-6 md:w-8 md:h-8 rounded-full border-2 border-gray-300 mr-3 flex-shrink-0"></div>
                                <div class="text-sm md:text-base">${option}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="text-center text-xs md:text-sm text-gray-500">
                    Pilih salah satu jawaban yang benar
                </div>
            `;
        }

        // Select answer in quiz
        function selectAnswer(selectedIndex) {
            const quizData = quizQuestions[currentQuiz];
            const question = quizData[currentQuestion];
            
            // Disable all options
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            // Mark correct and incorrect answers
            const options = document.querySelectorAll('.quiz-option');
            options[question.correct].classList.add('border-green-500', 'bg-green-50');
            options[question.correct].querySelector('div > div').innerHTML = '<i class="fas fa-check text-green-500"></i>';
            
            if (selectedIndex !== question.correct) {
                options[selectedIndex].classList.add('border-red-500', 'bg-red-50');
                options[selectedIndex].querySelector('div > div').innerHTML = '<i class="fas fa-times text-red-500"></i>';
                document.getElementById('wrongSound').play();
            } else {
                quizScore++;
                document.getElementById('correctSound').play();
            }
            
            // Show explanation and next button after a delay
            setTimeout(() => {
                document.getElementById('quizContent').innerHTML += `
                    <div class="bg-gray-100 p-4 rounded-lg mb-6 animate-fadeIn">
                        <h5 class="font-bold text-gray-800 mb-2">Penjelasan:</h5>
                        <p class="text-sm md:text-base text-gray-700">${question.explanation}</p>
                    </div>
                    
                    <button onclick="nextQuestion()" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 md:py-4 rounded-lg font-bold text-sm md:text-base hover:from-blue-600 hover:to-blue-700 transition-all">
                        ${currentQuestion < quizData.length - 1 ? 'Pertanyaan Selanjutnya' : 'Selesaikan Kuis'}
                    </button>
                `;
            }, 1000);
        }

        // Next question in quiz
        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion < quizQuestions[currentQuiz].length) {
                displayQuizQuestion();
            } else {
                finishQuiz();
            }
        }

        // Finish quiz
        function finishQuiz() {
            const totalQuestions = quizQuestions[currentQuiz].length;
            const percentage = (quizScore / totalQuestions) * 100;
            
            // Update user progress
            if (currentQuiz === 'zakat') {
                userData.quizScores.zakat = percentage;
                userData.progress.zakat = Math.max(userData.progress.zakat, percentage);
                userData.badges++;
                updateProgress();
            }
            
            // Show quiz results
            document.getElementById('quizContent').innerHTML = `
                <div class="text-center py-4 md:py-8">
                    <div class="text-4xl md:text-5xl font-bold text-blue-600 mb-4">${percentage.toFixed(0)}%</div>
                    <h3 class="text-xl md:text-2xl font-bold text-gray-800 mb-2">Hasil Kuis Zakat Fitrah</h3>
                    <p class="text-gray-600 mb-6">Anda menjawab benar ${quizScore} dari ${totalQuestions} pertanyaan</p>
                    
                    <div class="mb-6 md:mb-8">
                        ${percentage >= 80 ? `
                            <div class="bg-green-100 text-green-800 p-4 rounded-lg">
                                <i class="fas fa-trophy text-2xl md:text-3xl mb-2"></i>
                                <p class="font-bold">Selamat! Anda lulus dengan nilai sangat baik</p>
                            </div>
                        ` : percentage >= 60 ? `
                            <div class="bg-yellow-100 text-yellow-800 p-4 rounded-lg">
                                <i class="fas fa-medal text-2xl md:text-3xl mb-2"></i>
                                <p class="font-bold">Bagus! Nilai Anda cukup baik</p>
                            </div>
                        ` : `
                            <div class="bg-red-100 text-red-800 p-4 rounded-lg">
                                <i class="fas fa-redo text-2xl md:text-3xl mb-2"></i>
                                <p class="font-bold">Anda perlu belajar lagi. Jangan menyerah!</p>
                            </div>
                        `}
                    </div>
                    
                    <div class="flex space-x-4">
                        <button onclick="closeQuiz()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-bold hover:bg-gray-600 transition-all">
                            Tutup
                        </button>
                        <button onclick="showQuiz('zakat')" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-lg font-bold hover:from-blue-600 hover:to-blue-700 transition-all">
                            Ulangi Kuis
                        </button>
                    </div>
                </div>
            `;
        }

        // Close quiz modal
        function closeQuiz() {
            document.getElementById('quizModal').classList.add('hidden');
        }

        // Close explanation modal
        function closeExplanation() {
            document.getElementById('explanationModal').classList.add('hidden');
        }

        // Close payment modal
        function closePayment() {
            document.getElementById('paymentModal').classList.add('hidden');
        }

        // Calculate zakat fitrah
        function calculateZakatFitrah() {
            const familyMembers = parseInt(document.getElementById('familyMembers').value) || 1;
            const zakatUnit = document.getElementById('zakatUnit').value;
            
            if (familyMembers < 1) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Jumlah anggota keluarga harus minimal 1!',
                });
                return;
            }
            
            let resultText = '';
            
            if (zakatUnit === 'beras') {
                const totalBeras = familyMembers * 2.5;
                resultText = `Zakat fitrah untuk ${familyMembers} anggota keluarga adalah <strong>${totalBeras} kg</strong> beras.`;
            } else {
                const ricePrice = parseInt(document.getElementById('ricePrice').value) || 15000;
                const totalMoney = familyMembers * 2.5 * ricePrice;
                resultText = `Zakat fitrah untuk ${familyMembers} anggota keluarga adalah <strong>Rp ${totalMoney.toLocaleString('id-ID')}</strong> (setara dengan ${familyMembers * 2.5} kg beras).`;
            }
            
            document.getElementById('zakatResultText').innerHTML = resultText;
            document.getElementById('zakatResult').classList.remove('hidden');
            
            // Show payment simulation button
            document.getElementById('zakatResult').innerHTML += `
                <div class="mt-4 text-center">
                    <button onclick="simulatePayment('zakat')" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-2 rounded-lg font-bold text-sm hover:from-green-600 hover:to-green-700 transition-all">
                        <i class="fas fa-credit-card mr-2"></i>Simulasi Pembayaran
                    </button>
                </div>
            `;
        }

        // Calculate zakat maal
        function calculateZakatMaal() {
            const totalWealth = parseInt(document.getElementById('totalWealth').value) || 0;
            const debt = parseInt(document.getElementById('debt').value) || 0;
            const nisab = parseInt(document.getElementById('nisab').value) || 85000000;
            
            const netWealth = totalWealth - debt;
            
            if (netWealth < nisab) {
                document.getElementById('zakatMaalResultText').innerHTML = `
                    Harta bersih Anda adalah <strong>Rp ${netWealth.toLocaleString('id-ID')}</strong> yang masih di bawah nisab (<strong>Rp ${nisab.toLocaleString('id-ID')}</strong>). 
                    Anda <strong>tidak wajib</strong> mengeluarkan zakat maal.
                `;
            } else {
                const zakatAmount = netWealth * 0.025;
                document.getElementById('zakatMaalResultText').innerHTML = `
                    Harta bersih Anda adalah <strong>Rp ${netWealth.toLocaleString('id-ID')}</strong> yang sudah mencapai nisab. 
                    Zakat maal yang harus Anda keluarkan adalah <strong>2.5%</strong> x Rp ${netWealth.toLocaleString('id-ID')} = <strong>Rp ${zakatAmount.toLocaleString('id-ID')}</strong>.
                `;
                
                // Show payment simulation button
                document.getElementById('zakatMaalResult').innerHTML += `
                    <div class="mt-4 text-center">
                        <button onclick="simulatePayment('maal')" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-2 rounded-lg font-bold text-sm hover:from-green-600 hover:to-green-700 transition-all">
                            <i class="fas fa-credit-card mr-2"></i>Simulasi Pembayaran
                        </button>
                    </div>
                `;
            }
            
            document.getElementById('zakatMaalResult').classList.remove('hidden');
        }

        // Simulate payment
        function simulatePayment(type) {
            document.getElementById('paymentContent').innerHTML = `
                <div class="text-center mb-6">
                    <i class="fas fa-credit-card text-4xl text-green-500 mb-4"></i>
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Simulasi Pembayaran Zakat</h4>
                    <p class="text-gray-600">Pilih metode pembayaran:</p>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="payment-method p-4 border-2 border-gray-300 rounded-xl text-center cursor-pointer" data-method="transfer">
                        <i class="fas fa-exchange-alt text-2xl text-blue-500 mb-2"></i>
                        <p class="text-sm font-medium">Transfer Bank</p>
                    </div>
                    <div class="payment-method p-4 border-2 border-gray-300 rounded-xl text-center cursor-pointer" data-method="qris">
                        <i class="fas fa-qrcode text-2xl text-green-500 mb-2"></i>
                        <p class="text-sm font-medium">QRIS</p>
                    </div>
                    <div class="payment-method p-4 border-2 border-gray-300 rounded-xl text-center cursor-pointer" data-method="cash">
                        <i class="fas fa-money-bill-wave text-2xl text-yellow-500 mb-2"></i>
                        <p class="text-sm font-medium">Tunai</p>
                    </div>
                    <div class="payment-method p-4 border-2 border-gray-300 rounded-xl text-center cursor-pointer" data-method="ewallet">
                        <i class="fas fa-mobile-alt text-2xl text-purple-500 mb-2"></i>
                        <p class="text-sm font-medium">E-Wallet</p>
                    </div>
                </div>
                
                <div id="paymentDetails" class="hidden">
                    <div class="bg-gray-100 p-4 rounded-lg mb-4">
                        <h5 class="font-bold text-gray-800 mb-2">Detail Pembayaran:</h5>
                        <p class="text-sm text-gray-700" id="paymentDescription"></p>
                    </div>
                    
                    <button onclick="completePayment()" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-lg font-bold hover:from-green-600 hover:to-green-700 transition-all">
                        <i class="fas fa-check-circle mr-2"></i>Konfirmasi Pembayaran
                    </button>
                </div>
            `;
            
            document.getElementById('paymentModal').classList.remove('hidden');
            
            // Add event listeners to payment methods
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const paymentMethod = this.getAttribute('data-method');
                    let description = '';
                    
                    switch(paymentMethod) {
                        case 'transfer':
                            description = 'Silakan transfer ke rekening BSI 7123456789 a.n. BAZNAS Kota Singkawang';
                            break;
                        case 'qris':
                            description = 'Scan QR code berikut dengan aplikasi e-wallet atau mobile banking Anda';
                            break;
                        case 'cash':
                            description = 'Silakan datang ke kantor BAZNAS terdekat untuk pembayaran tunai';
                            break;
                        case 'ewallet':
                            description = 'Silakan gunakan aplikasi e-wallet (Gopay, OVO, Dana, dll) untuk pembayaran';
                            break;
                    }
                    
                    document.getElementById('paymentDescription').textContent = description;
                    document.getElementById('paymentDetails').classList.remove('hidden');
                });
            });
        }

        // Complete payment simulation
        function completePayment() {
            closePayment();
            
            Swal.fire({
                icon: 'success',
                title: 'Pembayaran Berhasil!',
                text: 'Zakat Anda telah berhasil dibayarkan. Semoga menjadi amal yang diterima Allah SWT.',
                timer: 3000,
                showConfirmButton: false
            });
            
            // Award badge for payment simulation
            userData.badges++;
            updateProgress();
        }

        // Generate certificate
        function generateCertificate() {
            const totalProgress = Object.values(userData.progress).reduce((a, b) => a + b, 0) / 4;
            const certificateScore = totalProgress >= 90 ? 'A' : totalProgress >= 80 ? 'B' : totalProgress >= 70 ? 'C' : 'D';
            
            document.getElementById('certificateName').textContent = userData.name;
            document.getElementById('certificateDate').textContent = `Tanggal: ${new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}`;
            document.getElementById('certificateScore').textContent = certificateScore;
            
            document.getElementById('certificateContainer').classList.remove('hidden');
            
            // Add download button
            document.getElementById('generateCertificate').innerHTML = '<i class="fas fa-download mr-2"></i>Unduh Sertifikat';
            document.getElementById('generateCertificate').onclick = downloadCertificate;
        }

        // Download certificate
        function downloadCertificate() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('landscape', 'pt', 'a4');
            
            const certificate = document.getElementById('certificateContainer');
            
            html2canvas(certificate, {
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = doc.internal.pageSize.getWidth();
                const imgHeight = doc.internal.pageSize.getHeight();
                
                doc.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                doc.save(`Sertifikat_Fikih_${userData.name}.pdf`);
                
                Swal.fire({
                    icon: 'success',
                    title: 'Unduhan Dimulai!',
                    text: 'Sertifikat Anda sedang diunduh dalam format PDF.',
                    timer: 2000,
                    showConfirmButton: false
                });
            });
        }

        // Update study time
        function updateStudyTime() {
            const now = new Date();
            const diff = Math.floor((now - startTime) / 1000);
            const minutes = Math.floor(diff / 60);
            
            userData.studyTime = minutes;
            document.getElementById('studyTime').textContent = `${minutes} menit`;
        }

        // Update progress display
        function updateProgress() {
            const totalProgress = Object.values(userData.progress).reduce((a, b) => a + b, 0) / 4;
            
            // Update progress bars
            document.getElementById('userProgressBar').style.width = `${totalProgress}%`;
            document.getElementById('userProgressBarMobile').style.width = `${totalProgress}%`;
            document.getElementById('userProgressText').textContent = `${Math.round(totalProgress)}%`;
            document.getElementById('userProgressTextMobile').textContent = `${Math.round(totalProgress)}%`;
            
            // Update zakat progress
            document.getElementById('zakatProgress').textContent = `${Math.round(userData.progress.zakat)}%`;
            document.getElementById('zakatProgressBar').style.width = `${userData.progress.zakat}%`;
            document.getElementById('zakatOverallScore').textContent = `${Math.round(userData.progress.zakat)}%`;
            document.getElementById('zakatOverallProgress').style.width = `${userData.progress.zakat}%`;
            
            // Update dashboard stats
            document.getElementById('totalBadges').textContent = userData.badges;
            document.getElementById('completedModules').textContent = `${userData.completedModules}/4`;
            
            // Unlock next modules based on progress
            if (userData.progress.zakat >= 70) {
                document.getElementById('infakMenu').classList.remove('opacity-50', 'cursor-not-allowed');
                document.getElementById('infakDashboard').classList.remove('opacity-50');
            }
            
            if (userData.progress.infak >= 80) {
                document.getElementById('sedekahMenu').classList.remove('opacity-50', 'cursor-not-allowed');
                document.getElementById('sedekahDashboard').classList.remove('opacity-50');
            }
            
            if (userData.progress.sedekah >= 90) {
                document.getElementById('qurbanMenu').classList.remove('opacity-50', 'cursor-not-allowed');
                document.getElementById('qurbanDashboard').classList.remove('opacity-50');
            }
        }
    </script>
</body>
</html>
